<!doctype html><html lang=en-gb><head><meta name=author content="Edmund Goodman"><meta name=description content="The personal website for Edmund Goodman"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/images/favicon.ico sizes=any type=image/x-icon><title>Github SSH Authentication | Edmund Goodman</title>
<link rel=stylesheet href=https://edmundgoodman.github.io/scss/main.min.css></head><body><nav><ul class=nav-menu><li class="nav-item nav-home"><a href=/>Home</a></li><li class="nav-item nav-elided"><a href=/about/>About</a></li><li class="nav-item nav-elided"><a href=/posts/>Blog</a></li><li class=nav-item><a href=/atlas/>Atlas</a></li></ul></nav><main><header><h1>Github SSH Authentication</h1><div class=post-meta><svg width="1.25em" height="1.25em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom:-.3em"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V7z"/><path d="M16 3v4"/><path d="M8 3v4"/><path d="M4 11h16"/><path d="M7 14h.013"/><path d="M10.01 14h.005"/><path d="M13.01 14h.005"/><path d="M16.015 14h.005"/><path d="M13.015 17h.005"/><path d="M7.01 17h.005"/><path d="M10.01 17h.005"/></svg>
<time datetime=2024-12-17>Dec 17, 2024</time>
&nbsp;&bull;&nbsp;
<svg width="1.25em" height="1.25em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom:-.3em"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>
5 minutes</div><br></header><article><h2 id=why-do-i-need-to-do-this>Why do I need to do this?</h2><p>From August 2021, GitHub announced they would not be allowing password
authentication when using the command line <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. This means that in order to
interact with GitHub from the command line you have to use another
authentication method.</p><p>This blog post enumerates the process of
configuring <code>git</code> and GitHub to use SSH keys, and some tips to streamline their
day-to-day usage. It is also available as a
<a href=https://gist.github.com/EdmundGoodman/e8faa0b3c2dddf350a00fb23dab48a59>gist</a>.</p><h2 id=using-ssh-keys> Using SSH keys</h2><p>SSH keys are one of the authentication methods that can be used instead of
passwords. Atlassian defines them as follows:</p><blockquote><p>SSH keys are generated through a public key cryptographic algorithm, the most
common being RSA or DSA. At a very high level SSH keys are generated through a
mathematical formula that takes 2 prime numbers and a random seed variable to
output the public and private key. This is a one-way formula that ensures the
public key can be derived from the private key but the private key cannot be
derived from the public key.</p><p>&ndash; <em>Atlassian</em> <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p></blockquote><h3 id=why-should-i-use-ssh-keys>Why should I use SSH keys?</h3><p>SSH keys provide a number of benefits over traditional password authentication,
which motivated its disablement for the command line. These include being
unique, revocable, limited, and random <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><p>Another alternative to authenticate to GitHub is token authentication, as
discussed in <a href=https://edmundgoodman.github.io/posts/2023/github-token-authentication/>an earlier blog post</a>.
However, this approach comes with a number of drawbacks including only
providing access to the repositories rather than account settings and having
the option of password protection, making them much more secure even if leaked <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.</p><h3 id=how-do-i-use-ssh-keys>How do I use SSH keys?</h3><p>The process for creating and using SSH keys is described in the
<a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh>GitHub documentation</a>,
and enumerated below:</p><ol><li><p>Check if any SSH keys already exist with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ls -al ~/.ssh
</span></span></code></pre></div><p>If the directory exists and contains a pair of public and private key files
(look for files called <code>id_rsa.pub</code>, <code>id_ecdsa.pub</code>, <code>id_ed25519.pub</code> or similar),
you may choose to re-use these in step 3.</p></li><li><p>If not, generate a new key with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen -t ed25519 -C <span style=color:#e6db74>&#34;your_email@example.com&#34;</span>
</span></span></code></pre></div><p>This will then prompt you to pick an algorithm (the default is probably
sensible), and a passphrase (pick a long and secure one, as on MacOS this
can be stored in the keychain and filled automatically, as discussed
<a href=#avoiding-password-prompts-on-macos>in a later section</a>).</p></li><li><p>Add the key to <code>ssh-agent</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>eval <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>ssh-agent -s<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>Which should output something similar to &ldquo;<code>> Agent pid 59566</code>&rdquo;.</p></li><li><p>Update your <code>~/.ssh/config</code> file with <code>vi</code> <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vi ~/.ssh/config
</span></span></code></pre></div><p>to contain the following entry</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a></span><span>Host github.com
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>2</a></span><span>    AddKeysToAgent yes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>3</a></span><span>    IdentityFile ~/.ssh/id_ed25519
</span></span></code></pre></div><p>This can be modified to auto-fill on MacOS using the keychain, as discussed
<a href=#avoiding-password-prompts-on-macos>in a later section</a>).</p></li><li><p>Add the key as an authentication method to GitHub, by copying the public key
file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat ~/.ssh/id_ed25519.pub
</span></span></code></pre></div><p>then add it as a new authentication SSH key to GitHub with the form at
<a href=https://github.com/settings/ssh/new>https://github.com/settings/ssh/new</a>, with a meaningful title and the copied
public key</p><figure><img src=/images/posts/github_ssh_authentication/create_key.png alt="A screenshot of adding a SSH authentication key to GitHub"><figcaption><p>A screenshot of adding a SSH authentication key to GitHub.</p></figcaption></figure><p>This will then show on the <a href=https://github.com/settings/keys>GitHub SSH keys page</a>.</p><figure><img src=/images/posts/github_ssh_authentication/authentication_keys.png alt="A screenshot of added keys on the GitHub SSH keys page"><figcaption><p>A screenshot of added keys on the GitHub SSH keys page.</p></figcaption></figure></li></ol><h3 id=tips-and-gotchas>Tips and gotchas</h3><p>When using SSH keys, there are a couple of things which can make your life
easier/harder. Some of them I have encountered are enumerated below.</p><h4 id=avoiding-password-prompts-on-macos>Avoiding password prompts on MacOS</h4><p>On MacOS, the SSH key password can be added to the user keychain, significantly
reducing the friction when interacting with the remote. This step is listed in
the GitHub docs for MacOS, first updating the SSH config file as follows <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a></span><span>Host github.com
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2>2</a></span><span>  AddKeysToAgent yes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3>3</a></span><span>  UseKeychain yes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4>4</a></span><span>  IdentityFile ~/.ssh/id_ed25519
</span></span></code></pre></div><p>Then, using the following command when adding the SSH key:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-add --apple-use-keychain ~/.ssh/id_ed25519
</span></span></code></pre></div><h4 id=correctly-configuring-remotes>Correctly configuring remotes</h4><p>An easy point of confusion when using SSH keys is that different remotes are
required than when authenticating over HTTPS. For HTTPS, remotes tend to look
like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>https://github.com/&lt;USERNAME&gt;/&lt;REPOSITORY&gt;
</span></span></code></pre></div><p>But when using SSH keys, remotes must be of the following format:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>git@github.com:&lt;USERNAME&gt;/&lt;REPOSITORY&gt;
</span></span></code></pre></div><p>As such, you may need to modify some repository remotes if switching from HTTPS
to SSH authentication. This can be done as follows, for the example of the <code>origin</code> remote:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git remote remove origin
</span></span><span style=display:flex><span>git remote add origin git@github.com:&lt;USERNAME&gt;/&lt;REPOSITORY&gt;
</span></span></code></pre></div><h4 id=automatically-using-ssh-remote-urls>Automatically using SSH remote URLs</h4><p>To address <a href=#correctly-configuring-remotes>the above issue</a>, you
can configure <code>git</code> to rewrite HTTPS to SSH remote sources as follows <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git config --global url.ssh://git@github.com/.insteadOf https://github.com/
</span></span></code></pre></div><p>However, this presents the possibility of difficult-to-debug errors with remotes,
so care should be taken if it is set.</p><h4 id=using-an-ssh-key-to-sign-commits>Using an SSH key to sign commits</h4><p>In addition to authenticating with, you can sign commits with your SSH key, with
instructions for doing this <a href=https://docs.github.com/en/authentication/managing-commit-signature-verification/telling-git-about-your-signing-key#telling-git-about-your-ssh-key>available here</a>.</p><p>First, you then need to add your SSH key as a &ldquo;Signing key&rdquo; (separate from an
&ldquo;Authentication key&rdquo;, but on the same page) to GitHub with the form at
<a href=https://github.com/settings/ssh/new>https://github.com/settings/ssh/new</a>. This is the same process as
<a href=#how-do-i-use-ssh-keys>adding an authentication key</a>,
but the key type must be set as a signing key, as shown below. This will then
show on the <a href=https://github.com/settings/keys>GitHub SSH keys page</a>.</p><figure><img src=/images/posts/github_ssh_authentication/signing_keys.png alt="A screenshot of added keys on the GitHub SSH keys page"><figcaption><p>A screenshot of added keys on the GitHub SSH keys page.</p></figcaption></figure><p>Then, you can configure <code>git</code> to use the SSH key for signing all commits and tags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git config --global gpg.format ssh
</span></span><span style=display:flex><span>git config --global user.signingkey ~/.ssh/id_ed25519
</span></span><span style=display:flex><span>git config --global commit.gpgsign true
</span></span><span style=display:flex><span>git config --global tag.gpgSign true
</span></span></code></pre></div><p>Finally, this will then mark new signed commits as verified on GitHub, as shown
below:</p><figure><img src=/images/posts/github_ssh_authentication/verified_commits.png alt="A screenshot of verified commits shown in a GitHub history"><figcaption><p>A screenshot of verified commits shown in a GitHub history.</p></figcaption></figure><h2 id=references>References</h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://github.blog/changelog/2021-08-12-git-password-authentication-is-shutting-down/>https://github.blog/changelog/2021-08-12-git-password-authentication-is-shutting-down/</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://www.atlassian.com/git/tutorials/git-ssh>https://www.atlassian.com/git/tutorials/git-ssh</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://github.blog/security/application-security/token-authentication-requirements-for-git-operations/#background>https://github.blog/security/application-security/token-authentication-requirements-for-git-operations/#background</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://stackoverflow.com/a/37095306>https://stackoverflow.com/a/37095306</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://stackoverflow.com/a/11828573>https://stackoverflow.com/a/11828573</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#adding-your-ssh-key-to-the-ssh-agent>https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#adding-your-ssh-key-to-the-ssh-agent</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p><a href=https://stackoverflow.com/a/22027731>https://stackoverflow.com/a/22027731</a>&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article></main><footer><p>© 2024 Edmund Goodman | 
<a href=https://github.com/EdmundGoodman/edmundgoodman.github.io>Source</a> | 
<a href=https://creativecommons.org/licenses/by-nc/4.0/>License</a></p></footer></body></html>