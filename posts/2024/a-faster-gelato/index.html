<!doctype html><html lang=en-gb><head><meta name=author content="Edmund Goodman"><meta name=description content="The personal website for Edmund Goodman"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/images/favicon.ico sizes=any type=image/x-icon><title>A Faster Gelato | Edmund Goodman</title>
<link rel=stylesheet href=https://edmundgoodman.github.io/scss/main.min.css><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><script>MathJax={tex:{displayMath:[["\\[","\\]"],["$$","$$"]],inlineMath:[["\\(","\\)"]]},loader:{load:["ui/safe"]}}</script></head><body><nav><ul class=nav-menu><li class="nav-item nav-home"><a href=/>Home</a></li><li class="nav-item nav-elided"><a href=/about/>About</a></li><li class="nav-item nav-elided"><a href=/posts/>Blog</a></li><li class=nav-item><a href=/atlas/>Atlas</a></li></ul></nav><main><header><h1>A Faster Gelato</h1><div class=post-meta><svg width="1.25em" height="1.25em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom:-.3em"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V7z"/><path d="M16 3v4"/><path d="M8 3v4"/><path d="M4 11h16"/><path d="M7 14h.013"/><path d="M10.01 14h.005"/><path d="M13.01 14h.005"/><path d="M16.015 14h.005"/><path d="M13.015 17h.005"/><path d="M7.01 17h.005"/><path d="M10.01 17h.005"/></svg>
<time datetime=2024-10-27>Oct 27, 2024</time>
&nbsp;&bull;&nbsp;
<svg width="1.25em" height="1.25em" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom:-.3em"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>
3 minutes</div><br></header><article><p>I love Jack&rsquo;s Gelato. Unfortunately, their website&rsquo;s menu sucks.
<a href=https://edmundgoodman.co.uk/gelato/>So I fixed it.</a></p><h2 id=why-the-existing-menu-sucks>Why the existing menu sucks</h2><p>The most noticeable issue of the current website is that it takes
<strong>5.8 seconds</strong> to display the menu. To add insult to injury, the text
&ldquo;Can take a few seconds to load..&rdquo; is shown whilst you wait.</p><figure><img src=/images/posts/a_faster_gelato/offending_text.png alt="A screenshot of Jack's Gelato menu website." id=figure-1><figcaption><p><strong>Figure 1: </strong>A screenshot of Jack&rsquo;s Gelato menu website.</p></figcaption></figure><p>Using Firefox&rsquo;s web inspector tools, we can trace the network requests made to
load the website HTML to attempt to diagnose the cause of the slow loading
times.</p><figure><img src=/images/posts/a_faster_gelato/jacks_gelato_slow_load.png alt="A screenshot of the Firefox network inspector for the page load." id=figure-2><figcaption><p><strong>Figure 2: </strong>A screenshot of the Firefox network inspector for the page load.</p></figcaption></figure><p>This shows that the dominant factor in menu latency is that it is served as an
embedded Google Doc through a Wix plugin. This plugin spends over a second
interacting with its <a href=https://www.mymobileapp.online>developer&rsquo;s website</a>, then
277ms retrieving a placeholder document to show before it starts retrieving the
actual menu document. Finally, it retrieves the menu document for a total of 5.8
seconds of menu latency.</p><figure><img src=/images/posts/a_faster_gelato/wix_placeholder.png alt="A screenshot of the placeholder document, retrieved by blocking request." id=figure-3><figcaption><p><strong>Figure 3: </strong>A screenshot of the placeholder document, retrieved by blocking request.</p></figcaption></figure><p>On top of the slow load times, the website transmits 9.5MB zipped of resources
<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. In contrast, the gzipped text content of a
<a href=https://raw.githubusercontent.com/EdmundGoodman/jacks-menu-history/refs/heads/main/raw/24_10_04__benet_street.txt>representative menu</a> is 570 bytes <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. On my
pay-as-you-go data plan charging 10p per MB <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>, it costs nearly one pound to
load the menu website. Whilst much of this blame can be attributed
to price gouging by mobile service providers, it does strongly motivate making
a lighter and faster website.</p><h2 id=how-i-made-it-better>How I made it better</h2><p>Tl;dr (full write-up coming soon):</p><ol><li>Wrote a <a href=https://pypi.org/project/jacks-menu/>Python package</a> which:<ul><li>Extracts the menu Google Doc URL using Selenium</li><li>Retrieves a text representation of the menu using the Google Docs API</li><li>Parses the text representation with a finite-state machine <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></li><li>Generates a markdown document from the parsed menu</li></ul></li><li>Wrote a <a href=https://github.com/EdmundGoodman/jacks-menu-history/blob/main/.github/workflows/gelato.yml>cron job</a> in GitHub Actions which runs the package at 10:20am every
day to retrieve the menu into an <a href=https://github.com/EdmundGoodman/jacks-menu-history>artefact repository</a></li><li>Wrote <a href=https://github.com/EdmundGoodman/edmundgoodman.github.io/blob/main/.github/workflows/gh-pages.yml>another cron job</a> which deploys the generated markdown menu
artefacts onto my statically hosted website on GitHub Pages (for free) at
10:25am every day</li></ol><p>My version of the website takes 147ms to load (3% of the original time), and
transmits only 9.52kB of data (0.8% of the original size, 0.7p cost in
pay-as-you-go data). By omitting the favicon, inlining the CSS, and eliding
the inlined SVG icons this could likely be reduced to ~2kB and 40ms &ndash; but for
now I am happy with the performance.</p><figure><img src=/images/posts/a_faster_gelato/mine_trace.png alt="A screenshot of the Firefox network inspector for the page load." id=figure-4><figcaption><p><strong>Figure 4: </strong>A screenshot of the Firefox network inspector for the page load.</p></figcaption></figure><h2 id=please-dont-sue-me-disclaimer>Please don&rsquo;t sue me disclaimer</h2><p>All copyright and intellectual property of the menu contents belongs to
<a href=https://www.jacksgelato.com/>Jack&rsquo;s Gelato</a>.</p><p>I will comply with any requests to take this website down, but I hope it never
comes to that. For me, this is just a fun different way to access the menu,
as it makes it a bit easier/faster to work out what the flavours are each day.</p><p>Additionally, their website runs no advertising so this is not depriving them of
profit in that respect.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>1.02MB of HTML, 9.5MB total including JavaScript and other resources.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>This means the information a customer cares about, which icecream
is available that day, is transmitted at approximately \(\frac{570 \times 8}{5.8} \approx 786\) bits per second,
0.00314% of the <a href=https://simrush.com/fastest-4g-network-uk/>lower-bound average 4G bandwidth in the UK</a>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://www.three.co.uk/content/dam/threedigital/terms-and-conditions/price-guides/latest-price-guides/paygplans-priceguide-12052023.pdf>Three Pay As You Go Price Guide</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>This by identity could be expressed as a regular expression, but the
finite-state machine is a little more readable and hence maintainable when
the menu format inevitably changes&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article></main><footer><p>Â© 2025 Edmund Goodman | 
<a href=https://github.com/EdmundGoodman/edmundgoodman.github.io>Source</a> | 
<a href=https://creativecommons.org/licenses/by-nc/4.0/>License</a></p></footer></body></html>