<!doctype html><html lang=en-gb><head><meta name=author content="Edmund Goodman"><meta name=description content="The personal website for Edmund Goodman"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/images/favicon.ico sizes=any type=image/x-icon><title>Benchmarking LLVM MLIR | Edmund Goodman</title><link rel=stylesheet href=https://edmundgoodman.github.io/scss/main.min.css></head><body><nav><ul class=nav-menu><li class="nav-item nav-home"><a href=/>Home</a></li><li class="nav-item nav-elided"><a href=/about/>About</a></li><li class="nav-item nav-elided"><a href=/posts/>Blog</a></li><li class=nav-item><a href=/atlas/>Atlas</a></li></ul></nav><main><header><h1>Benchmarking LLVM MLIR</h1><div class=post-meta><svg width="1.25em" height="1.25em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom:-.3em"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V7z"/><path d="M16 3v4"/><path d="M8 3v4"/><path d="M4 11h16"/><path d="M7 14h.013"/><path d="M10.01 14h.005"/><path d="M13.01 14h.005"/><path d="M16.015 14h.005"/><path d="M13.015 17h.005"/><path d="M7.01 17h.005"/><path d="M10.01 17h.005"/></svg>
<time datetime=2025-04-09>Apr 9, 2025</time>
&nbsp;&bull;&nbsp;
<svg width="1.25em" height="1.25em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom:-.3em"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1018 0A9 9 0 003 12"/><path d="M12 7v5l3 3"/></svg>
1 minute</div><br></header><article><p>At the 2024 European LLVM Developers&rsquo; Meeting, Mehdi Amini and Jeff Nui
presented their keynote talk &ldquo;How Slow is MLIR&rdquo; [^1]. This presented
micro-benchmarks for key operations in the MLIR compiler, such as traversing the
IR and creating operations. However, the code for the benchmarks and
instructions for running them are not easily available online alongside the
talk. This blog post addresses this gap in the provision.</p><h2 id=the-benchmarks>The benchmarks</h2><p>By asking the in the LLVM discord and spelunking around GitHub, I found the
benchmarks discussed in this talk are available on a branch of Mehdi&rsquo;s fork of
LLVM <a href=https://github.com/joker-eph/llvm-project/tree/benchmarks>available here</a>,
with a diff with the main branch
<a href=https://github.com/llvm/llvm-project/compare/main...joker-eph:llvm-project:benchmarks>available here</a>.</p><h2 id=running-the-benchmarks>Running the benchmarks</h2><p>To run the benchmarks, first clone the repository at the correct branch:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a></span><span>git clone -b benchmarks https://github.com/joker-eph/llvm-project/
</span></span></code></pre></div><p>Then, built the appropriate CMake target:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a></span><span>mkdir llvm-project/build
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a></span><span>cd llvm-project/build
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a></span><span>cmake -G Ninja ../llvm <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a></span><span><span style=color:#ae81ff></span>   -DLLVM_ENABLE_PROJECTS<span style=color:#f92672>=</span>mlir <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5>5</a></span><span><span style=color:#ae81ff></span>   -DLLVM_TARGETS_TO_BUILD<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;host&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6>6</a></span><span><span style=color:#ae81ff></span>   -DLLVM_ENABLE_BENCHMARKS<span style=color:#f92672>=</span>ON <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7>7</a></span><span><span style=color:#ae81ff></span>   -DCMAKE_BUILD_TYPE<span style=color:#f92672>=</span>Release <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-8>8</a></span><span><span style=color:#ae81ff></span>   -DCMAKE_C_COMPILER<span style=color:#f92672>=</span>clang -DCMAKE_CXX_COMPILER<span style=color:#f92672>=</span>clang++
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-9>9</a></span><span>cmake --build . --target MLIR_IR_Benchmark
</span></span></code></pre></div><p>Finally, run the benchmarks:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a></span><span>./tools/mlir/unittests/Benchmarks/MLIR_IR_Benchmark
</span></span></code></pre></div><h2 id=references>References</h2><p>[^1] <a href="https://www.youtube.com/watch?v=7qvVMUSxqz4">https://www.youtube.com/watch?v=7qvVMUSxqz4</a>
[^2] <a href=https://llvm.org/devmtg/2024-04/slides/Keynote/Amini-Niu-HowSlowIsMLIR.pdf>https://llvm.org/devmtg/2024-04/slides/Keynote/Amini-Niu-HowSlowIsMLIR.pdf</a>
[^3] <a href=https://mlir.llvm.org/>https://mlir.llvm.org/</a>
[^4] <a href=https://mlir.llvm.org/getting_started/>https://mlir.llvm.org/getting_started/</a></p></article></main><footer><p>Â© 2025 Edmund Goodman | 
<a href=https://github.com/EdmundGoodman/edmundgoodman.github.io>Source</a> | 
<a href=https://creativecommons.org/licenses/by-nc/4.0/>License</a></p></footer></body></html>